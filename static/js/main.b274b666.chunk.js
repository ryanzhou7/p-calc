(this["webpackJsonpcreate-react-plus"]=this["webpackJsonpcreate-react-plus"]||[]).push([[0],{24:function(e,t,a){e.exports=a.p+"static/media/thick-half.34a74ea6.png"},27:function(e,t,a){e.exports=a(45)},32:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},43:function(e,t,a){e.exports=a.p+"static/media/top-max.9741321e.jpeg"},45:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(11),c=a.n(i),o=(a(32),a(47)),s=a(19),u=a(20),l=a.n(u),h=a(2);var d={source:null};var f=a(5),m=a(1),v=a.n(m),g=a(3);function p(e){return{type:"SET_COMBINE_CONTEXT",payload:e}}var y={context:null,numColoredOuterPixels:0,numColoredInnerPixels:0};var b=a(9);a(41);var E=function(e){var t=Object(f.b)(),a=e.image,i=e.canvasDimensions,c=i.canvasWidth,o=i.canvasHeight,s=e.drawDimensions,u=s.drawWidth,l=s.drawHeight,h=Object(b.a)(e.canvasContext,2),d=h[0],m=h[1],v=Object(n.useRef)(null);return Object(n.useEffect)((function(){var e=v.current.getContext("2d");t(m(e))}),[]),Object(n.useEffect)((function(){if(null!=a&&null!=d){var e=v.current;e.width=c,e.height=o,d.drawImage(a,0,0,u,l)}}),[a,u,l,c,o]),r.a.createElement("div",null,r.a.createElement("canvas",{ref:v,className:"border"}))},O=a(7),x=a(12),w=function e(t){var a=t.x,n=t.y;Object(x.a)(this,e),this.x=a,this.y=n},j=a(22),_=function(){function e(t){var a=t.canvasWidth,n=t.imageArray;Object(x.a)(this,e),this.canvasWidth=a,this.imageArray=n}return Object(j.a)(e,[{key:"rgbPixel",value:function(e){var t=e.x,a=e.y,n=C(t,a,this.canvasWidth)+0,r=C(t,a,this.canvasWidth)+1,i=C(t,a,this.canvasWidth)+2,c=this.imageArray[n],o=this.imageArray[r],s=this.imageArray[i];if(0!==c&&0!==o&&0!==s){var u=C(t,a,this.canvasWidth)+3;this.imageArray[u]}return{r:c,g:o,b:s}}},{key:"rgbaPixel",value:function(e){var t=e.x,a=e.y,n=this.rgbPixel({x:t,y:a}),r=C(t,a,this.canvasWidth)+3,i=this.imageArray[r];return n.alpha=i,n}},{key:"recolor",value:function(e,t){var a=t.r,n=t.g,r=t.b,i=e.x,c=e.y,o=C(i,c,this.canvasWidth)+0,s=C(i,c,this.canvasWidth)+1,u=C(i,c,this.canvasWidth)+2;this.imageArray[o]=Number(a),this.imageArray[s]=Number(n),this.imageArray[u]=Number(r)}},{key:"rRelative",value:function(e){var t=this.rgbPixel(e);t.r,t.g;return t.b}},{key:"tint",value:function(e,t){var a=t.r,n=t.g,r=t.b,i=e.x,c=e.y,o=C(i,c,this.canvasWidth)+0,s=C(i,c,this.canvasWidth)+1,u=C(i,c,this.canvasWidth)+2,l=this.imageArray[o],h=this.imageArray[s],d=this.imageArray[u];this.imageArray[o]+=this.tintDelta(l,a),this.imageArray[s]+=this.tintDelta(h,n),this.imageArray[u]+=this.tintDelta(d,r)}},{key:"tintDelta",value:function(e,t){return(t-e)/3}}]),e}();function C(e,t,a){return 4*(e+t*a)}function I(e,t,a,n){return T.apply(this,arguments)}function T(){return(T=Object(g.a)(v.a.mark((function e(t,a,n,r){var i,c,o,s,u,l,h,d,f;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a.x,a.y,(i=[]).push(a),(c=[]).push(a),(o=new Set).add(a),0;c.length>0;){s=c.pop(),M(s.x,s.y),u=S(s),l=Object(O.a)(u);try{for(l.s();!(h=l.n()).done;)d=h.value,f=M(d.x,d.y),!o.has(f)&&N(s,d,t,a)&&A(d,r)&&(c.push(d),i.push(d)),o.add(f)}catch(n){l.e(n)}finally{l.f()}0}return e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t,a,n){var r=a.rgbPixel(n),i=2*r.r-r.g-r.b,c=a.rgbPixel(e),o=a.rgbPixel(t);return 2*o.r-o.g-o.b+45>i&&Math.abs(c.r-o.r)<100&&Math.abs(c.g-o.g)<100&&Math.abs(c.b-o.b)<100}function A(e,t){var a=e.x,n=e.y;return a>0&&a<t.width&&n>0&&n<t.height}var R=[[-1,0],[0,-1],[0,1],[1,0]];function S(e){var t,a=[],n=e.x,r=e.y,i=Object(O.a)(R);try{for(i.s();!(t=i.n()).done;){var c=t.value,o=Object(b.a)(c,2),s=o[0],u=o[1];a.push(new w({x:s+n,y:u+r}))}}catch(l){i.e(l)}finally{i.f()}return a}function P(e,t,a,n){return D.apply(this,arguments)}function D(){return(D=Object(g.a)(v.a.mark((function e(t,a,n,r){var i,c,o,s,u,l,h,d,f,m,g,p,y;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=a.leftX,c=a.rightX,o=a.height,s=0,u=new Set,l=Object(O.a)(r);try{for(l.s();!(h=l.n()).done;)for(d=h.value,f=d.x,m=d.y,g=m;g<o/2;g++)p=M(f,g),y={x:f,y:g},!u.has(p)&&i<=f&&f<=c&&(u.add(p),t.tint(y,n),s++)}catch(v){l.e(v)}finally{l.f()}return e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t){return String(e)+String(t)}var W=a(10),k=a.n(W);function X(e,t){return L.apply(this,arguments)}function L(){return(L=Object(g.a)(v.a.mark((function e(t,a){var n,r,i,c,o,s,u,l,h;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.width,r=t.height,a.drawImage(t,0,0,n,r),i=a.getImageData(0,0,n,r),450,320,c=k.a.U8_t,o=new k.a.matrix_t(450,320,c),k.a.imgproc.grayscale(i.data,n,r,o),3,8,120,120,k.a.imgproc.gaussian_blur(o,o,8,0),k.a.imgproc.canny(o,o,120,120),s=new Uint32Array(i.data.buffer),255<<24,u=o.cols*o.rows,l=0;--u>=0;)l=o.data[u],s[u]=255<<24|l<<16|l<<8|l;return a.putImageData(i,0,0,0,0,n,r),h=new _({canvasWidth:n,imageArray:i.data}),e.abrupt("return",h);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t,a){return H.apply(this,arguments)}function H(){return(H=Object(g.a)(v.a.mark((function e(t,a,n){var r,i,c,o,s,u,l,h,d,f,m,g,p,y,b,E,O,x,w,j,C,T;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.width,i=t.height,c={detectionWidth:r,detectionHeight:i},o=n.current,s=o.getContext("2d"),e.next=6,X(t,s);case 6:return u=e.sent,(l=a.context).drawImage(t,0,0,r,i),h=l.getImageData(0,0,r,i),d=new _({canvasWidth:c.detectionWidth,imageArray:h.data}),e.next=13,V(d,c);case 13:return f=e.sent,e.next=16,I(d,f,u,{width:r,height:i});case 16:return m=e.sent,e.next=19,F(f,m,d,r,i);case 19:return g=e.sent,e.next=22,I(d,g,u,{width:r,height:i});case 22:return p=e.sent,l.putImageData(h,0,0,0,0,c.detectionWidth,c.detectionHeight),y=m,b=p,f.y>g.y&&(y=(E=[b,y])[0],b=E[1]),e.next=29,J(y,b);case 29:return O=e.sent,x=O.left,w=O.right,j={r:0,g:255,b:0},e.next=35,P(d,{leftX:x,rightX:w,height:i},j,y);case 35:return C=e.sent,e.next=38,P(d,{leftX:x,rightX:w,height:i},{r:0,g:255,b:255},b);case 38:return T=e.sent,l.putImageData(h,0,0,0,0,c.detectionWidth,c.detectionHeight),e.abrupt("return",Promise.resolve({topPixelsCount:C,bottomPixelsCount:T,context:l}));case 41:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,a,n,r){return G.apply(this,arguments)}function G(){return(G=Object(g.a)(v.a.mark((function e(t,a,n,r,i){var c,o,s,u,l,h,d,f,m,g,p,y,b,E,x,w;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=i/2,o=r/2,s=Math.abs(t.y-c),u=t.y,h=(l=s<u)?Number.MIN_VALUE:Number.MAX_VALUE,d=l?Math.max:Math.min,f=Object(O.a)(a);try{for(f.s();!(m=f.n()).done;)g=m.value.y,h=d(h,g)}catch(v){f.e(v)}finally{f.f()}for(h+=l?-5:5,p={x:o},y=0,b=l?0:c;b!==h;)E={x:o,y:b},x=n.rgbPixel(E),(w=2*x.r-x.b-x.g)>y&&(p.y=b,y=w),l?b++:b--;return e.abrupt("return",p);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e,t){return B.apply(this,arguments)}function B(){return(B=Object(g.a)(v.a.mark((function e(t,a){var n,r,i,c,o,s,u,l,h;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=a.detectionWidth,r=a.detectionHeight,c={x:i=n/2},o=0,s=0;s<r/2;s++)u={x:i,y:s},l=t.rgbPixel(u),(h=2*l.r-l.b-l.g)>o&&(c.y=s,o=h);return e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t){return z.apply(this,arguments)}function z(){return(z=Object(g.a)(v.a.mark((function e(t,a){var n,r,i,c,o,s,u,l,h,d,f,m;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Number.MAX_VALUE,r=Number.MAX_VALUE,i=0,c=0,o=Object(O.a)(t);try{for(o.s();!(s=o.n()).done;)u=s.value,l=u.x,n=Math.min(n,l),i=Math.max(i,l)}catch(v){o.e(v)}finally{o.f()}h=Object(O.a)(a);try{for(h.s();!(d=h.n()).done;)f=d.value,m=f.x,r=Math.min(r,m),c=Math.max(c,m)}catch(v){h.e(v)}finally{h.f()}return e.abrupt("return",{left:Math.max(n,r),right:Math.min(i,c)});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=function(e){Object(f.b)(),Object(f.c)((function(e){return e.outerCanvasInfo})),Object(f.c)((function(e){return e.innerCanvasInfo}));var t,a=Object(f.c)((function(e){return e.combinedCanvasInfo})),i=(Object(f.c)((function(e){return e.canvasSettings.canvasDimensions})),Object(f.c)((function(e){return e.image.source}))),c=a.numColoredOuterPixels,s=a.numColoredInnerPixels,u=e.webcamRef,l=Object(h.a)({},e,{canvasContext:[a.context,p]}),d=Object(n.useRef)(null);function m(){return(m=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(i,a,d);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",null,r.a.createElement("div",{className:"d-flex justify-content-around align-items-center"},r.a.createElement(E,l),r.a.createElement("canvas",{style:{display:"none"},ref:d}),r.a.createElement("div",null,r.a.createElement(o.a,{className:"my-1",variant:"outline-primary",onClick:function(){window.scrollTo(0,u.current.offsetTop)}},"Retake"),r.a.createElement("div",null,r.a.createElement("div",{className:"my-4"},r.a.createElement(o.a,{className:"mr-4",variant:"outline-primary"},"-"),r.a.createElement(o.a,{variant:"outline-primary"},"+")),r.a.createElement(o.a,{onClick:function(){!function(){m.apply(this,arguments)}()}},"Analyze")),r.a.createElement("div",{className:"mt-4"},"Loss:"," ",(100*((t=c)-s)/t).toFixed(4),"%"))))},$=a(24),q=a.n($);a(42);a(43);var K=Object(s.withOrientationChange)((function(e){var t=Object(f.b)(),a=Object(f.c)((function(e){return e.videoReducer.videoConstraints})),i=Object(f.c)((function(e){return e.image.source})),c=Object(f.c)((function(e){return e.canvasSettings.canvasDimensions})),s=e.isPortrait,u=Object(n.useRef)(null),h=Object(n.useRef)(null),d=Object(n.useRef)(null);Object(n.useEffect)((function(){}),[]);var m=Object(n.useCallback)((function(){var e,a=u.current.getScreenshot();t((e=a,function(t){var a=new Image;a.onload=function(){t({type:"IMAGE_SET",payload:a})},a.src=e})),window.scrollTo(0,d.current.offsetTop)}),[u]),v={webcamRef:u,image:i,canvasDimensions:{canvasWidth:c.width,canvasHeight:c.height},drawDimensions:{drawWidth:c.width,drawHeight:c.height}};return r.a.createElement("div",{className:"App"},r.a.createElement("h2",null,"Ptosis calculator"),s&&r.a.createElement("h5",null,"Please rotate your device"),!s&&r.a.createElement("div",{className:"d-flex justify-content-around align-items-center",ref:h},r.a.createElement("div",{style:{position:"relative",float:"top"}},r.a.createElement(l.a,{audio:!1,height:a.height,ref:u,screenshotFormat:"image/jpeg",width:a.width,videoConstraints:a}),r.a.createElement("div",{className:"overlay"},r.a.createElement("img",{className:"target",style:{height:a.height},src:q.a}))),r.a.createElement("div",{className:"my-3"},r.a.createElement(o.a,{onClick:function(){return m()}},"Take picture"))),r.a.createElement("div",{ref:d},r.a.createElement(Q,v)))}));var Y=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(K,null))};var Z=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(44);var ee=a(8),te=a(25);var ae={isOuterEdit:!0};var ne={context:null,recoloredImageData:null,numColoredPixels:0,detectedPixels:[],recolorHex:"#00FF00"};var re={context:null,recoloredImageData:null,numColoredPixels:0,detectedPixels:[],recolorHex:"#FFA500"};var ie={canvasDimensions:{width:450,height:320}};var ce={videoConstraints:{width:450,height:320,facingMode:{exact:"environment"},audio:!1,imageSmoothing:!0,screenshotQuality:1}};var oe=Object(ee.c)({image:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IMAGE_SET":return Object(h.a)({},e,{source:t.payload});default:return e}},canvasEdit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_IS_OUTER_EDIT":return Object(h.a)({},e,{isOuterEdit:!e.isOuterEdit});default:return e}},innerCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_INNER_CONTEXT":return Object(h.a)({},e,{context:t.payload});case"SET_INNER_RECOLORED_IMAGE_DATA":return Object(h.a)({},e,{recoloredImageData:t.payload});case"SET_INNER_DETECTED_PIXELS":return Object(h.a)({},e,{detectedPixels:t.payload});case"SET_INNER_NUM_COLORED_PIXELS":return Object(h.a)({},e,{numColoredPixels:t.payload});case"SET_INNER_RECOLOR_HEX":return Object(h.a)({},e,{recolorHex:t.payload});default:return e}},outerCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_OUTER_CONTEXT":return Object(h.a)({},e,{context:t.payload});case"SET_OUTER_RECOLORED_IMAGE_DATA":return Object(h.a)({},e,{recoloredImageData:t.payload});case"SET_OUTER_DETECTED_PIXELS":return Object(h.a)({},e,{detectedPixels:t.payload});case"SET_OUTER_NUM_COLORED_PIXELS":return Object(h.a)({},e,{numColoredPixels:t.payload});case"SET_OUTER_RECOLOR_HEX":return Object(h.a)({},e,{recolorHex:t.payload});default:return e}},combinedCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_COMBINE_CONTEXT":return Object(h.a)({},e,{context:t.payload});case"SET_NUM_COLORED_INNER_PIXELS":return Object(h.a)({},e,{numColoredInnerPixels:t.payload});case"SET_NUM_COLORED_OUTER_PIXELS":return Object(h.a)({},e,{numColoredOuterPixels:t.payload});default:return e}},canvasSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CANVAS_DIMENSIONS":return Object(h.a)({},e,{source:t.payload});default:return e}},videoReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;return t.type,e}}),se=Object(ee.d)(oe,Object(ee.a)(te.a));c.a.render(r.a.createElement(f.a,{store:se},r.a.createElement(Z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.b274b666.chunk.js.map