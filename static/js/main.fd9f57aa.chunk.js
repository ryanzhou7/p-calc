(this["webpackJsonpcreate-react-plus"]=this["webpackJsonpcreate-react-plus"]||[]).push([[0],{36:function(e,t,n){e.exports=n(61)},41:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(12),i=n.n(c),o=(n(41),n(7)),l=n(64),u=n(65),s=n(66),d=n(63);var f={width:"300px"},E=function(e){var t=e.label,n=e.accept,a=e.onChangeHandler;return r.a.createElement("div",null,r.a.createElement(d.a.File,{type:"file",accept:n,label:t,style:f,custom:!0,onChange:function(e){return a(e)}}))},m=n(9),p=n(6);function v(e){return{type:"SET_INNER_CONTEXT",payload:e}}function h(e){return{type:"SET_INNER_DETECTED_PIXELS",payload:e}}function O(e){return{type:"SET_INNER_RECOLOR_HEX",payload:e}}var y={context:null,recoloredImageData:null,numColoredPixels:0,detectedPixels:[],recolorHex:"#00FF00"};function b(e){return{type:"SET_OUTER_CONTEXT",payload:e}}function g(e){return{type:"SET_OUTER_DETECTED_PIXELS",payload:e}}function x(e){return{type:"SET_OUTER_RECOLOR_HEX",payload:e}}var _={context:null,recoloredImageData:null,numColoredPixels:0,detectedPixels:[],recolorHex:"#FFA500"};var C={isOuterEdit:!0};var j=function(){var e=Object(p.c)((function(e){return e.canvasEdit.isOuterEdit})),t=Object(p.b)(),n=function(){t({type:"TOGGLE_IS_OUTER_EDIT"})};return r.a.createElement("div",null,r.a.createElement("div",null,"Currently editing:"),r.a.createElement(s.a,{active:e,className:"mr-2",variant:"outline-danger",onClick:n},"Outer"),r.a.createElement(s.a,{active:!e,variant:"outline-primary",onClick:n},"Inner"))},T=n(5),I=n.n(T),N=n(8),w=n(11);n(49);function S(e){return function(t,n,a){return 2*t-(n+a)>255-e}}function R(e){return function(t,n,a){return 2*a-(n+t)>255-e}}function D(e,t,n,a){return P.apply(this,arguments)}function P(){return(P=Object(N.a)(I.a.mark((function e(t,n,a,r){var c,i,o,l,u,s,d,f,E,p,v,h,O,y,b,g,x,_;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c=n.detectionWidth,i=n.detectionHeight,o=t.getImageData(0,0,c,i),l=G(r),u=Object(m.a)(l,3),s=u[0],d=u[1],f=u[2],E=[],p=o.data.slice(),v=0;v<i/2;v++)for(h=0;h<c;h++)O=F(h,v,c)+0,y=F(h,v,c)+1,b=F(h,v,c)+2,g=p[O],x=p[y],_=p[b],a(g,x,_)&&(o.data[O]=Number(s),o.data[y]=Number(d),o.data[b]=Number(f),E.push({x:h,y:v}));return e.abrupt("return",Promise.resolve([o,E]));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t,n,a,r){return k.apply(this,arguments)}function k(){return(k=Object(N.a)(I.a.mark((function e(t,n,a,r,c){var i,o,l,u,s,d,f;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.width,o=t.height,l=c.leftX,u=c.rightX,s=r.context.getImageData(0,0,i,o),e.next=5,L({width:i,height:o},s,{leftX:l,rightX:u},n);case 5:return d=e.sent,e.next=8,L({width:i,height:o},s,{leftX:l,rightX:u},a);case 8:return f=e.sent,e.abrupt("return",Promise.resolve({imageData:s,outerNumPixelsColored:d,innerNumPixelsColored:f}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t,n,a){return M.apply(this,arguments)}function M(){return(M=Object(N.a)(I.a.mark((function e(t,n,a,r){var c,i,o,l,u,s,d,f,E,p,v,h,O,y,b,g,x,_,C,j,T,N,S,R;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.width,i=t.height,o=a.leftX,l=a.rightX,u=G(r.recolorHex),s=Object(m.a)(u,3),d=s[0],f=s[1],E=s[2],p=H(r.detectedPixels,{leftX:o,rightX:l}),v=p.numDetectedPixels,h=p.existingPixels,O=A(U,h),window.existingPixels=h,y=Object(w.a)(h);try{for(y.s();!(b=y.n()).done;)if(g=Object(m.a)(b.value,2),null!=(x=g[1]))for(_=x.x,C=x.y,j=C;j<i/2;j++)O(_,j)||(T=F(_,j,c)+0,N=F(_,j,c)+1,S=F(_,j,c)+2,n.data[T]=d,n.data[N]=f,n.data[S]=E,R=U(_,j),h.set(R,null),v++)}catch(I){y.e(I)}finally{y.f()}return e.abrupt("return",v);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t){var n,a=t.leftX,r=t.rightX,c=new Map,i=0,o=Object(w.a)(e);try{for(o.s();!(n=o.n()).done;){var l=n.value,u=l.x,s=l.y;if(u>=a&&u<=r){var d=U(u,s);c.set(d,l),i++}}}catch(f){o.e(f)}finally{o.f()}return{numDetectedPixels:i,existingPixels:c}}function U(e,t){return String(e)+String(t)}function A(e,t){return function(n,a){var r=e(n,a);return t.has(r)}}function G(e){var t=0,n=0,a=0;return 4==e.length?(t="0x"+e[1]+e[1],n="0x"+e[2]+e[2],a="0x"+e[3]+e[3]):7==e.length&&(t="0x"+e[1]+e[2],n="0x"+e[3]+e[4],a="0x"+e[5]+e[6]),[t,n,a]}function F(e,t,n){return 4*(e+t*n)}function W(e,t,n,a){null!=e&&e.drawImage(a,0,0,t,n)}function B(){return(B=Object(N.a)(I.a.mark((function e(t,n,a,r,c,i){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),W(n,a,r,c),i(0);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var K=function(e){var t=Object(p.b)(),n=Object(p.c)((function(e){return e.image.source})),a=Object(p.c)((function(e){return e.canvasEdit.isOuterEdit})),c=Object(p.c)((function(e){return e.outerCanvasInfo})),i=Object(p.c)((function(e){return e.innerCanvasInfo})),o=a?c:i,l=e.recolorHex,u=Object(m.a)(e.detectionThreshold,1)[0],d=Object(p.c)((function(e){return e.canvasSettings.canvasDimensions})),f=d.width,E=d.height;function O(){return(O=Object(N.a)(I.a.mark((function e(r,c){var i,o,s,d,f,E,p,O;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),i=n.width,o=n.height,s={detectionWidth:i,detectionHeight:o},d=a?S(u):R(u),e.next=6,D(c,s,d,l);case 6:f=e.sent,E=Object(m.a)(f,2),p=E[0],O=E[1],c.putImageData(p,0,0,0,0,i,o),t((a?b:v)(c)),t((a?g:h)(O));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",null,r.a.createElement(s.a,{variant:"outline-primary",className:"mx-1",onClick:function(e){return function(e,t){return O.apply(this,arguments)}(e,o.context)}},"Recolor detected"),r.a.createElement(s.a,{variant:"outline-primary",className:"mx-1",onClick:function(e){var r=a?function(e){return function(t){e(function(e){return{type:"SET_OUTER_NUM_COLORED_PIXELS",payload:e}}(t))}}(t):function(e){return function(t){e(function(e){return{type:"SET_INNER_NUM_COLORED_PIXELS",payload:e}}(t))}}(t);t((a?g:h)([])),function(e,t,n,a,r,c){B.apply(this,arguments)}(e,o.context,f,E,n,r)}},"Reset"))};n(57);var J=function(e){var t=Object(p.b)(),n=Object(a.useState)(0),c=Object(m.a)(n,2),i=c[0],l=c[1],u=function(e){l((function(t){var n=(t=parseInt(t))+e;return n=(n=n<0?0:n)>255?255:n}))},f=Object(p.c)((function(e){return e.canvasEdit.isOuterEdit})),E=f?x:O,v=Object(p.c)((function(e){return e.innerCanvasInfo.recolorHex})),h=Object(p.c)((function(e){return e.outerCanvasInfo.recolorHex})),y=f?h:v,b=Object(o.a)({detectionThreshold:[i,l]},e,{recolorHex:y});return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(j,null)),r.a.createElement("div",null,r.a.createElement(d.a.Label,null,"Recolor:"),r.a.createElement(d.a.Control,{className:"mx-auto input",type:"color",value:y,onChange:function(e){var n=e.target.value;t(E(n))}})),r.a.createElement("div",null,r.a.createElement(d.a.Label,null,"Sensitivity: ",i),r.a.createElement("div",{className:"d-flex mx-auto justify-content-center"},r.a.createElement(s.a,{onClick:function(e){e.preventDefault(),u(-15)},variant:"outline-primary"},"-15"),r.a.createElement(s.a,{className:"mx-2",onClick:function(e){e.preventDefault(),u(-5)},variant:"outline-primary"},"-5"),r.a.createElement(d.a.Control,{className:"input mx-2",type:"range",min:0,max:255,value:i,onChange:function(e){return l(e.target.value)}}),r.a.createElement(s.a,{className:"mx-2",onClick:function(e){e.preventDefault(),u(5)},variant:"outline-primary"},"+5"),r.a.createElement(s.a,{onClick:function(e){e.preventDefault(),u(15)},variant:"outline-primary"},"+15"))),r.a.createElement("div",{className:"m-2"},r.a.createElement(K,b)))};function Q(e){return V.apply(this,arguments)}function V(){return(V=Object(N.a)(I.a.mark((function e(t){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){if(t.target.files&&t.target.files.item(0)){var a=URL.createObjectURL(t.target.files[0]),r=new Image;return r.onload=function(){return e(r)},void(r.src=a)}n("No file selected")})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=Object(N.a)(I.a.mark((function e(t,n){var a;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q(t);case 2:a=e.sent,n(a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(58);var q=function(e){var t=Object(p.b)(),n=e.image,c=e.canvasDimensions,i=c.canvasWidth,o=c.canvasHeight,l=e.drawDimensions,u=l.drawWidth,s=l.drawHeight,d=Object(m.a)(e.canvasContext,2),f=d[0],E=d[1],v=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=v.current.getContext("2d");t(E(e))}),[]),Object(a.useEffect)((function(){if(null!=n&&null!=f&&null!=v){var e=v.current;e.width=i,e.height=o,f.drawImage(n,0,0,u,s)}}),[n,u,s,i,o,f]),r.a.createElement("div",null,r.a.createElement("canvas",{ref:v,className:"border"}))},z=n(32),Y=n.n(z);var Z={source:null};function ee(e){return{type:"SET_COMBINE_CONTEXT",payload:e}}function te(e){return{type:"SET_NUM_COLORED_INNER_PIXELS",payload:e}}function ne(e){return{type:"SET_NUM_COLORED_OUTER_PIXELS",payload:e}}var ae={context:null,numColoredOuterPixels:0,numColoredInnerPixels:0};function re(){return(re=Object(N.a)(I.a.mark((function e(t,n,a,r,c){var i,o,l,u,s,d,f,E;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.detectedPixels,o=n.detectedPixels,e.next=4,ce(i,o);case 4:return l=e.sent,e.next=7,oe(i,o);case 7:return u=e.sent,e.next=10,X(r,t,n,a,{leftX:l,rightX:u});case 10:s=e.sent,d=s.imageData,f=s.outerNumPixelsColored,E=s.innerNumPixelsColored,a.context.putImageData(d,0,0,0,0,r.width,r.height),c(ee(a.context)),c(te(E)),c(ne(f));case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e,t){return ie.apply(this,arguments)}function ie(){return(ie=Object(N.a)(I.a.mark((function e(t,n){var a,r,c,i,o,l,u,s,d,f;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Number.MAX_SAFE_INTEGER,r=Object(w.a)(t);try{for(r.s();!(c=r.n()).done;)i=c.value,o=i.x,a=Math.min(a,o)}catch(E){r.e(E)}finally{r.f()}l=Number.MAX_SAFE_INTEGER,u=Object(w.a)(n);try{for(u.s();!(s=u.n()).done;)d=s.value,f=d.x,l=Math.min(l,f)}catch(E){u.e(E)}finally{u.f()}return e.abrupt("return",Math.max(a,l));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e,t){return le.apply(this,arguments)}function le(){return(le=Object(N.a)(I.a.mark((function e(t,n){var a,r,c,i,o,l,u,s,d,f;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,r=Object(w.a)(t);try{for(r.s();!(c=r.n()).done;)i=c.value,o=i.x,a=Math.max(a,o)}catch(E){r.e(E)}finally{r.f()}l=0,u=Object(w.a)(n);try{for(u.s();!(s=u.n()).done;)d=s.value,f=d.x,l=Math.max(l,f)}catch(E){u.e(E)}finally{u.f()}return e.abrupt("return",Math.min(a,l));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ue=function(e){var t,n=Object(p.b)(),a=Object(p.c)((function(e){return e.outerCanvasInfo})),c=Object(p.c)((function(e){return e.innerCanvasInfo})),i=Object(p.c)((function(e){return e.combinedCanvasInfo})),l=Object(p.c)((function(e){return e.canvasSettings.canvasDimensions})),u=i.numColoredOuterPixels,d=i.numColoredInnerPixels,f=Object(o.a)({},e,{canvasContext:[i.context,ee]});return r.a.createElement("div",null,r.a.createElement(q,f),r.a.createElement(s.a,{className:"my-2",variant:"outline-primary",onClick:function(){!function(e,t,n,a,r){re.apply(this,arguments)}(a,c,i,l,n)}},"Recolor"),r.a.createElement("div",null,r.a.createElement("div",null,"Outer pixel count: ",u),r.a.createElement("div",null,"Inner pixel count: ",d),r.a.createElement("div",null,"Calculated Loss %:"," ",(100*((t=u)-d)/t).toFixed(4))))},se=(n(59),{width:380,height:380,facingMode:{exact:"environment"},audio:!1,imageSmoothing:!0,screenshotQuality:1});var de=function(){var e=Object(p.b)(),t=Object(p.c)((function(e){return e.image.source})),n=Object(p.c)((function(e){return e.innerCanvasInfo.context})),c=Object(p.c)((function(e){return e.outerCanvasInfo.context})),i=Object(p.c)((function(e){return e.canvasSettings.canvasDimensions})),d={image:t,canvasDimensions:{canvasWidth:i.width,canvasHeight:i.height},drawDimensions:{drawWidth:i.width,drawHeight:i.height},canvasContext:[c,b]},f=Object(o.a)({},d,{canvasContext:[n,v]}),m=Object(o.a)({},f),h=Object(a.useRef)(null),O=Object(a.useCallback)((function(){var t,n=h.current.getScreenshot();e((t=n,function(e){var n=new Image;n.onload=function(){e({type:"IMAGE_SET",payload:n})},n.src=t}))}),[h]);return r.a.createElement("div",{className:"App"},r.a.createElement("h4",null,"Welcome to P-calc"),r.a.createElement("div",null,r.a.createElement(l.a,{defaultActiveKey:"0"},r.a.createElement(u.a,null,r.a.createElement(u.a.Header,null,r.a.createElement(l.a.Toggle,{as:s.a,variant:"link",eventKey:"0"},"Image input")),r.a.createElement(l.a.Collapse,{eventKey:"0"},r.a.createElement(u.a.Body,null,r.a.createElement("div",{style:{position:"relative",backgroundColor:"grey",height:"800",display:"inline-block"}},r.a.createElement(Y.a,{audio:!1,height:380,ref:h,screenshotFormat:"image/jpeg",width:380,videoConstraints:se}),r.a.createElement("span",{className:"cross",style:{position:"absolute",top:192,right:0,bottom:192,left:0,backgroundColor:"red"}}),r.a.createElement("span",{className:"circle",style:{position:"absolute",top:0,right:0,bottom:0,left:0}}),r.a.createElement("span",{style:{position:"absolute",top:192,right:0,bottom:192,left:0,backgroundColor:"red"}})),r.a.createElement("div",{className:"my-3"},r.a.createElement(s.a,{onClick:O,variant:"outline-primary"},"Take picture")),r.a.createElement(E,{accept:"image/*",label:"Choose image",onChangeHandler:function(t){!function(e,t){$.apply(this,arguments)}(t,function(e){return function(t){e({type:"IMAGE_SET",payload:t})}}(e))}})))),r.a.createElement(u.a,null,r.a.createElement(u.a.Header,null,r.a.createElement(l.a.Toggle,{as:s.a,variant:"link",eventKey:"1"},"Image analysis")),r.a.createElement(l.a.Collapse,{eventKey:"1"},r.a.createElement(u.a.Body,null,r.a.createElement(q,d),r.a.createElement(q,f),r.a.createElement(J,null)))),r.a.createElement(u.a,null,r.a.createElement(u.a.Header,null,r.a.createElement(l.a.Toggle,{as:s.a,variant:"link",eventKey:"2"},"Results")),r.a.createElement(l.a.Collapse,{eventKey:"2"},r.a.createElement(u.a.Body,null,r.a.createElement("div",null,r.a.createElement(ue,m))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(60);var fe=n(15),Ee=n(34);var me={canvasDimensions:{width:400,height:400}};var pe=Object(fe.c)({image:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IMAGE_SET":return Object(o.a)({},e,{source:t.payload});default:return e}},canvasEdit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_IS_OUTER_EDIT":return Object(o.a)({},e,{isOuterEdit:!e.isOuterEdit});default:return e}},innerCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_INNER_CONTEXT":return Object(o.a)({},e,{context:t.payload});case"SET_INNER_RECOLORED_IMAGE_DATA":return Object(o.a)({},e,{recoloredImageData:t.payload});case"SET_INNER_DETECTED_PIXELS":return Object(o.a)({},e,{detectedPixels:t.payload});case"SET_INNER_NUM_COLORED_PIXELS":return Object(o.a)({},e,{numColoredPixels:t.payload});case"SET_INNER_RECOLOR_HEX":return Object(o.a)({},e,{recolorHex:t.payload});default:return e}},outerCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_OUTER_CONTEXT":return Object(o.a)({},e,{context:t.payload});case"SET_OUTER_RECOLORED_IMAGE_DATA":return Object(o.a)({},e,{recoloredImageData:t.payload});case"SET_OUTER_DETECTED_PIXELS":return Object(o.a)({},e,{detectedPixels:t.payload});case"SET_OUTER_NUM_COLORED_PIXELS":return Object(o.a)({},e,{numColoredPixels:t.payload});case"SET_OUTER_RECOLOR_HEX":return Object(o.a)({},e,{recolorHex:t.payload});default:return e}},combinedCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_COMBINE_CONTEXT":return Object(o.a)({},e,{context:t.payload});case"SET_NUM_COLORED_INNER_PIXELS":return Object(o.a)({},e,{numColoredInnerPixels:t.payload});case"SET_NUM_COLORED_OUTER_PIXELS":return Object(o.a)({},e,{numColoredOuterPixels:t.payload});default:return e}},canvasSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CANVAS_DIMENSIONS":return Object(o.a)({},e,{source:t.payload});default:return e}}}),ve=Object(fe.d)(pe,Object(fe.a)(Ee.a));i.a.render(r.a.createElement(p.a,{store:ve},r.a.createElement(de,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[36,1,2]]]);
//# sourceMappingURL=main.fd9f57aa.chunk.js.map