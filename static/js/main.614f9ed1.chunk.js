(this["webpackJsonpcreate-react-plus"]=this["webpackJsonpcreate-react-plus"]||[]).push([[0],{26:function(e,t,n){e.exports=n.p+"static/media/thicc-png.c9dcc9e1.png"},28:function(e,t,n){e.exports=n(53)},33:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(13),i=n.n(c),o=(n(33),n(6)),u=n(55),l=n(54);var s=n(9),d=n(5);function f(e){return{type:"SET_INNER_CONTEXT",payload:e}}function E(e){return{type:"SET_INNER_DETECTED_PIXELS",payload:e}}function m(e){return{type:"SET_INNER_RECOLOR_HEX",payload:e}}var v={context:null,recoloredImageData:null,numColoredPixels:0,detectedPixels:[],recolorHex:"#00FF00"};function p(e){return{type:"SET_OUTER_CONTEXT",payload:e}}function h(e){return{type:"SET_OUTER_DETECTED_PIXELS",payload:e}}function O(e){return{type:"SET_OUTER_RECOLOR_HEX",payload:e}}var x={context:null,recoloredImageData:null,numColoredPixels:0,detectedPixels:[],recolorHex:"#FFA500"};var y={isOuterEdit:!0};var b=function(){var e=Object(d.c)((function(e){return e.canvasEdit.isOuterEdit})),t=Object(d.b)(),n=function(){t({type:"TOGGLE_IS_OUTER_EDIT"})};return r.a.createElement("div",null,r.a.createElement("div",null,"Currently editing:"),r.a.createElement(u.a,{active:e,className:"mr-2",variant:"outline-danger",onClick:n},"Outer"),r.a.createElement(u.a,{active:!e,variant:"outline-primary",onClick:n},"Inner"))},g=n(4),_=n.n(g),C=n(8),j=n(10);n(41);function T(e){return function(t,n,a){return 2*t-(n+a)>255-e}}function I(e){return function(t,n,a){return 2*a-(n+t)>255-e}}function N(e,t,n,a){return S.apply(this,arguments)}function S(){return(S=Object(C.a)(_.a.mark((function e(t,n,a,r){var c,i,o,u,l,d,f,E,m,v,p,h,O,x,y,b,g,C;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c=n.detectionWidth,i=n.detectionHeight,o=t.getImageData(0,0,c,i),u=k(r),l=Object(s.a)(u,3),d=l[0],f=l[1],E=l[2],m=[],v=o.data.slice(),p=0;p<i/2;p++)for(h=0;h<c;h++)O=U(h,p,c)+0,x=U(h,p,c)+1,y=U(h,p,c)+2,b=v[O],g=v[x],C=v[y],a(b,g,C)&&(o.data[O]=Number(d),o.data[x]=Number(f),o.data[y]=Number(E),m.push({x:h,y:p}));return e.abrupt("return",Promise.resolve([o,m]));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t,n,a,r){return R.apply(this,arguments)}function R(){return(R=Object(C.a)(_.a.mark((function e(t,n,a,r,c){var i,o,u,l,s,d,f;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.width,o=t.height,u=c.leftX,l=c.rightX,s=r.context.getImageData(0,0,i,o),e.next=5,D({width:i,height:o},s,{leftX:u,rightX:l},n);case 5:return d=e.sent,e.next=8,D({width:i,height:o},s,{leftX:u,rightX:l},a);case 8:return f=e.sent,e.abrupt("return",Promise.resolve({imageData:s,outerNumPixelsColored:d,innerNumPixelsColored:f}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t,n,a){return P.apply(this,arguments)}function P(){return(P=Object(C.a)(_.a.mark((function e(t,n,a,r){var c,i,o,u,l,d,f,E,m,v,p,h,O,x,y,b,g,C,T,I,N,S,w,R;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.width,i=t.height,o=a.leftX,u=a.rightX,l=k(r.recolorHex),d=Object(s.a)(l,3),f=d[0],E=d[1],m=d[2],v=X(r.detectedPixels,{leftX:o,rightX:u}),p=v.numDetectedPixels,h=v.existingPixels,O=M(L,h),window.existingPixels=h,x=Object(j.a)(h);try{for(x.s();!(y=x.n()).done;)if(b=Object(s.a)(y.value,2),null!=(g=b[1]))for(C=g.x,T=g.y,I=T;I<i/2;I++)O(C,I)||(N=U(C,I,c)+0,S=U(C,I,c)+1,w=U(C,I,c)+2,n.data[N]=f,n.data[S]=E,n.data[w]=m,R=L(C,I),h.set(R,null),p++)}catch(_){x.e(_)}finally{x.f()}return e.abrupt("return",p);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t){var n,a=t.leftX,r=t.rightX,c=new Map,i=0,o=Object(j.a)(e);try{for(o.s();!(n=o.n()).done;){var u=n.value,l=u.x,s=u.y;if(l>=a&&l<=r){var d=L(l,s);c.set(d,u),i++}}}catch(f){o.e(f)}finally{o.f()}return{numDetectedPixels:i,existingPixels:c}}function L(e,t){return String(e)+String(t)}function M(e,t){return function(n,a){var r=e(n,a);return t.has(r)}}function k(e){var t=0,n=0,a=0;return 4==e.length?(t="0x"+e[1]+e[1],n="0x"+e[2]+e[2],a="0x"+e[3]+e[3]):7==e.length&&(t="0x"+e[1]+e[2],n="0x"+e[3]+e[4],a="0x"+e[5]+e[6]),[t,n,a]}function U(e,t,n){return 4*(e+t*n)}function H(e,t,n,a){null!=e&&e.drawImage(a,0,0,t,n)}function A(){return(A=Object(C.a)(_.a.mark((function e(t,n,a,r,c,i){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),H(n,a,r,c),i(0);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var G=function(e){var t=Object(d.b)(),n=Object(d.c)((function(e){return e.image.source})),a=Object(d.c)((function(e){return e.canvasEdit.isOuterEdit})),c=Object(d.c)((function(e){return e.outerCanvasInfo})),i=Object(d.c)((function(e){return e.innerCanvasInfo})),o=a?c:i,l=e.recolorHex,m=Object(s.a)(e.detectionThreshold,1)[0],v=Object(d.c)((function(e){return e.canvasSettings.canvasDimensions})),O=v.width,x=v.height;function y(){return(y=Object(C.a)(_.a.mark((function e(r,c){var i,o,u,d,v,O,x,y;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),i=n.width,o=n.height,u={detectionWidth:i,detectionHeight:o},d=a?T(m):I(m),e.next=6,N(c,u,d,l);case 6:v=e.sent,O=Object(s.a)(v,2),x=O[0],y=O[1],c.putImageData(x,0,0,0,0,i,o),t((a?p:f)(c)),t((a?h:E)(y));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",null,r.a.createElement(u.a,{variant:"outline-primary",className:"mx-1",onClick:function(e){return function(e,t){return y.apply(this,arguments)}(e,o.context)}},"Recolor detected"),r.a.createElement(u.a,{variant:"outline-primary",className:"mx-1",onClick:function(e){var r=a?function(e){return function(t){e(function(e){return{type:"SET_OUTER_NUM_COLORED_PIXELS",payload:e}}(t))}}(t):function(e){return function(t){e(function(e){return{type:"SET_INNER_NUM_COLORED_PIXELS",payload:e}}(t))}}(t);t((a?h:E)([])),function(e,t,n,a,r,c){A.apply(this,arguments)}(e,o.context,O,x,n,r)}},"Reset"))};n(49);var F=function(e){var t=Object(d.b)(),n=Object(a.useState)(0),c=Object(s.a)(n,2),i=c[0],f=c[1],E=function(e){f((function(t){var n=(t=parseInt(t))+e;return n=(n=n<0?0:n)>255?255:n}))},v=Object(d.c)((function(e){return e.canvasEdit.isOuterEdit})),p=v?O:m,h=Object(d.c)((function(e){return e.innerCanvasInfo.recolorHex})),x=Object(d.c)((function(e){return e.outerCanvasInfo.recolorHex})),y=v?x:h,g=Object(o.a)({detectionThreshold:[i,f]},e,{recolorHex:y});return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(b,null)),r.a.createElement("div",null,r.a.createElement(l.a.Label,null,"Recolor:"),r.a.createElement(l.a.Control,{className:"mx-auto input",type:"color",value:y,onChange:function(e){var n=e.target.value;t(p(n))}})),r.a.createElement("div",null,r.a.createElement(l.a.Label,null,"Sensitivity: ",i),r.a.createElement("div",{className:"d-flex mx-auto justify-content-center"},r.a.createElement(u.a,{onClick:function(e){e.preventDefault(),E(-15)},variant:"outline-primary"},"-15"),r.a.createElement(u.a,{className:"mx-2",onClick:function(e){e.preventDefault(),E(-5)},variant:"outline-primary"},"-5"),r.a.createElement(l.a.Control,{className:"input mx-2",type:"range",min:0,max:255,value:i,onChange:function(e){return f(e.target.value)}}),r.a.createElement(u.a,{className:"mx-2",onClick:function(e){e.preventDefault(),E(5)},variant:"outline-primary"},"+5"),r.a.createElement(u.a,{onClick:function(e){e.preventDefault(),E(15)},variant:"outline-primary"},"+15"))),r.a.createElement("div",{className:"m-2"},r.a.createElement(G,g)))};n(50);var W=function(e){var t=Object(d.b)(),n=e.image,c=e.canvasDimensions,i=c.canvasWidth,o=c.canvasHeight,u=e.drawDimensions,l=u.drawWidth,f=u.drawHeight,E=Object(s.a)(e.canvasContext,2),m=E[0],v=E[1],p=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=p.current.getContext("2d");t(v(e))}),[]),Object(a.useEffect)((function(){if(null!=n&&null!=m&&null!=p){var e=p.current;e.width=i,e.height=o,m.drawImage(n,0,0,l,f)}}),[n,l,f,i,o,m]),r.a.createElement("div",null,r.a.createElement("canvas",{ref:p,className:"border"}))},B=n(25),J=n.n(B);var Q={source:null};function V(e){return{type:"SET_COMBINE_CONTEXT",payload:e}}function $(e){return{type:"SET_NUM_COLORED_INNER_PIXELS",payload:e}}function q(e){return{type:"SET_NUM_COLORED_OUTER_PIXELS",payload:e}}var z={context:null,numColoredOuterPixels:0,numColoredInnerPixels:0};function K(){return(K=Object(C.a)(_.a.mark((function e(t,n,a,r,c){var i,o,u,l,s,d,f,E;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.detectedPixels,o=n.detectedPixels,e.next=4,Y(i,o);case 4:return u=e.sent,e.next=7,ee(i,o);case 7:return l=e.sent,e.next=10,w(r,t,n,a,{leftX:u,rightX:l});case 10:s=e.sent,d=s.imageData,f=s.outerNumPixelsColored,E=s.innerNumPixelsColored,a.context.putImageData(d,0,0,0,0,r.width,r.height),c(V(a.context)),c($(E)),c(q(f));case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t){return Z.apply(this,arguments)}function Z(){return(Z=Object(C.a)(_.a.mark((function e(t,n){var a,r,c,i,o,u,l,s,d,f;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Number.MAX_SAFE_INTEGER,r=Object(j.a)(t);try{for(r.s();!(c=r.n()).done;)i=c.value,o=i.x,a=Math.min(a,o)}catch(E){r.e(E)}finally{r.f()}u=Number.MAX_SAFE_INTEGER,l=Object(j.a)(n);try{for(l.s();!(s=l.n()).done;)d=s.value,f=d.x,u=Math.min(u,f)}catch(E){l.e(E)}finally{l.f()}return e.abrupt("return",Math.max(a,u));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(e,t){return te.apply(this,arguments)}function te(){return(te=Object(C.a)(_.a.mark((function e(t,n){var a,r,c,i,o,u,l,s,d,f;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,r=Object(j.a)(t);try{for(r.s();!(c=r.n()).done;)i=c.value,o=i.x,a=Math.max(a,o)}catch(E){r.e(E)}finally{r.f()}u=0,l=Object(j.a)(n);try{for(l.s();!(s=l.n()).done;)d=s.value,f=d.x,u=Math.max(u,f)}catch(E){l.e(E)}finally{l.f()}return e.abrupt("return",Math.min(a,u));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ne=function(e){var t,n=Object(d.b)(),a=Object(d.c)((function(e){return e.outerCanvasInfo})),c=Object(d.c)((function(e){return e.innerCanvasInfo})),i=Object(d.c)((function(e){return e.combinedCanvasInfo})),l=Object(d.c)((function(e){return e.canvasSettings.canvasDimensions})),s=i.numColoredOuterPixels,f=i.numColoredInnerPixels,E=Object(o.a)({},e,{canvasContext:[i.context,V]});return r.a.createElement("div",null,r.a.createElement(W,E),r.a.createElement(u.a,{className:"my-2",variant:"outline-primary",onClick:function(){!function(e,t,n,a,r){K.apply(this,arguments)}(a,c,i,l,n)}},"Recolor"),r.a.createElement("div",null,r.a.createElement("div",null,"Outer pixel count: ",s),r.a.createElement("div",null,"Inner pixel count: ",f),r.a.createElement("div",null,"Calculated Loss %:"," ",(100*((t=s)-f)/t).toFixed(4))))},ae=(n(51),n(26)),re=n.n(ae),ce={width:370,height:320,facingMode:"user",audio:!1,imageSmoothing:!0,screenshotQuality:1};var ie=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.image.source})),n=Object(d.c)((function(e){return e.innerCanvasInfo.context})),c=Object(d.c)((function(e){return e.outerCanvasInfo.context})),i=Object(d.c)((function(e){return e.canvasSettings.canvasDimensions})),l={image:t,canvasDimensions:{canvasWidth:i.width,canvasHeight:i.height},drawDimensions:{drawWidth:i.width,drawHeight:i.height},canvasContext:[c,p]},s=Object(o.a)({},l,{canvasContext:[n,f]}),E=Object(o.a)({},s),m=Object(a.useRef)(null),v=Object(a.useCallback)((function(){var t,n=m.current.getScreenshot();e((t=n,function(e){var n=new Image;n.onload=function(){e({type:"IMAGE_SET",payload:n})},n.src=t}))}),[m]);return r.a.createElement("div",{className:"App"},r.a.createElement("h4",null,"P-calc app"),r.a.createElement("div",{style:{position:"relative",float:"top"}},r.a.createElement(J.a,{audio:!1,height:320,ref:m,screenshotFormat:"image/jpeg",width:370,videoConstraints:ce}),r.a.createElement("div",{className:"overlay"},r.a.createElement("img",{src:re.a}))),r.a.createElement("div",{className:"my-3"},r.a.createElement(u.a,{onClick:v,variant:"outline-primary"},"Take picture")),r.a.createElement(W,l),r.a.createElement(W,s),r.a.createElement(F,null),r.a.createElement("div",null,r.a.createElement(ne,E)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(52);var oe=n(11),ue=n(27);var le={canvasDimensions:{width:400,height:400}};var se=Object(oe.c)({image:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IMAGE_SET":return Object(o.a)({},e,{source:t.payload});default:return e}},canvasEdit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_IS_OUTER_EDIT":return Object(o.a)({},e,{isOuterEdit:!e.isOuterEdit});default:return e}},innerCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_INNER_CONTEXT":return Object(o.a)({},e,{context:t.payload});case"SET_INNER_RECOLORED_IMAGE_DATA":return Object(o.a)({},e,{recoloredImageData:t.payload});case"SET_INNER_DETECTED_PIXELS":return Object(o.a)({},e,{detectedPixels:t.payload});case"SET_INNER_NUM_COLORED_PIXELS":return Object(o.a)({},e,{numColoredPixels:t.payload});case"SET_INNER_RECOLOR_HEX":return Object(o.a)({},e,{recolorHex:t.payload});default:return e}},outerCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_OUTER_CONTEXT":return Object(o.a)({},e,{context:t.payload});case"SET_OUTER_RECOLORED_IMAGE_DATA":return Object(o.a)({},e,{recoloredImageData:t.payload});case"SET_OUTER_DETECTED_PIXELS":return Object(o.a)({},e,{detectedPixels:t.payload});case"SET_OUTER_NUM_COLORED_PIXELS":return Object(o.a)({},e,{numColoredPixels:t.payload});case"SET_OUTER_RECOLOR_HEX":return Object(o.a)({},e,{recolorHex:t.payload});default:return e}},combinedCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_COMBINE_CONTEXT":return Object(o.a)({},e,{context:t.payload});case"SET_NUM_COLORED_INNER_PIXELS":return Object(o.a)({},e,{numColoredInnerPixels:t.payload});case"SET_NUM_COLORED_OUTER_PIXELS":return Object(o.a)({},e,{numColoredOuterPixels:t.payload});default:return e}},canvasSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CANVAS_DIMENSIONS":return Object(o.a)({},e,{source:t.payload});default:return e}}}),de=Object(oe.d)(se,Object(oe.a)(ue.a));i.a.render(r.a.createElement(d.a,{store:de},r.a.createElement(ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.614f9ed1.chunk.js.map