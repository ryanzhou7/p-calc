(this["webpackJsonpcreate-react-plus"]=this["webpackJsonpcreate-react-plus"]||[]).push([[0],{45:function(e,t,a){e.exports=a.p+"static/media/thick-half.34a74ea6.png"},49:function(e,t,a){e.exports=a(97)},54:function(e,t,a){},64:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){e.exports=a.p+"static/media/7.787a2096.jpeg"},97:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(21),c=a.n(i),o=(a(54),a(99)),s=a(100),u=a(40),l=a(41),h=a.n(l),d=a(4);var m={source:null,image:null};var f=a(9),v=a(1),E=a.n(v),p=a(6),g=a(14);function y(e){return{type:"SET_COMBINE_CONTEXT",payload:e}}function b(e){return{type:"SET_NUM_COLORED_INNER_PIXELS",payload:e}}function O(e){return{type:"SET_NUM_COLORED_OUTER_PIXELS",payload:e}}var x={context:null,numColoredOuterPixels:0,numColoredInnerPixels:0};var _=a(12);a(64);var w=function(e){var t=Object(f.b)(),a=e.image,i=e.canvasDimensions,c=i.canvasWidth,o=i.canvasHeight,s=e.drawDimensions,u=s.drawWidth,l=s.drawHeight,h=Object(g.a)(e.canvasContext,2),d=h[0],m=h[1],v=Object(n.useRef)(null);return Object(n.useEffect)((function(){var e=v.current.getContext("2d");t(m(e))}),[]),Object(n.useEffect)((function(){if(null!=a&&null!=d){var e=v.current;e.width=c,e.height=o,d.drawImage(a,0,0,u,l)}}),[a,u,l,c,o]),r.a.createElement("div",null,r.a.createElement("canvas",{ref:v,className:"border"}))},j=a(11),C=a(22),N=function e(t){var a=t.x,n=t.y;Object(C.a)(this,e),this.x=a,this.y=n},T=a(43),I=function(){function e(t){var a=t.canvasWidth,n=t.imageArray;Object(C.a)(this,e),this.canvasWidth=a,this.imageArray=n}return Object(T.a)(e,[{key:"rgbPixel",value:function(e){var t=e.x,a=e.y,n=S(t,a,this.canvasWidth)+0,r=S(t,a,this.canvasWidth)+1,i=S(t,a,this.canvasWidth)+2,c=this.imageArray[n],o=this.imageArray[r],s=this.imageArray[i];if(0!==c&&0!==o&&0!==s){var u=S(t,a,this.canvasWidth)+3;this.imageArray[u]}return{r:c,g:o,b:s}}},{key:"rgbaPixel",value:function(e){var t=e.x,a=e.y,n=this.rgbPixel({x:t,y:a}),r=S(t,a,this.canvasWidth)+3,i=this.imageArray[r];return n.alpha=i,n}},{key:"recolor",value:function(e,t){var a=t.r,n=t.g,r=t.b,i=e.x,c=e.y,o=S(i,c,this.canvasWidth)+0,s=S(i,c,this.canvasWidth)+1,u=S(i,c,this.canvasWidth)+2;this.imageArray[o]=Number(a),this.imageArray[s]=Number(n),this.imageArray[u]=Number(r)}},{key:"rRelative",value:function(e){var t=this.rgbPixel(e);t.r,t.g;return t.b}},{key:"tint",value:function(e,t){var a=t.r,n=t.g,r=t.b,i=e.x,c=e.y,o=S(i,c,this.canvasWidth)+0,s=S(i,c,this.canvasWidth)+1,u=S(i,c,this.canvasWidth)+2,l=this.imageArray[o],h=this.imageArray[s],d=this.imageArray[u];this.imageArray[o]+=this.tintDelta(l,a),this.imageArray[s]+=this.tintDelta(h,n),this.imageArray[u]+=this.tintDelta(d,r)}},{key:"tintDelta",value:function(e,t){return(t-e)/3}}]),e}();function S(e,t,a){return 4*(e+t*a)}var R=a(65),A=a(90);function P(e,t,a,n,r){return D.apply(this,arguments)}function D(){return(D=Object(p.a)(E.a.mark((function e(t,a,n,r,i){var c,o,s,u,l,h,d,m,f;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a.x,a.y,(c=[]).push(a),(o=[]).push(a),(s=new Set).add(a);o.length>0;){u=o.pop(),H(u.x,u.y),l=L(u),h=Object(j.a)(l);try{for(h.s();!(d=h.n()).done;)m=d.value,f=H(m.x,m.y),M(m,r)&&!s.has(f)&&k(m,t,a,i)&&(o.push(m),c.push(m)),s.add(f)}catch(n){h.e(n)}finally{h.f()}}return e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t,a,n){var r=t.rgbPixel(a),i=R.rgb.lab([r.r,r.g,r.b]),c={L:i[0],A:i[1],B:i[2]},o=t.rgbPixel(e),s=R.rgb.lab([o.r,o.g,o.b]),u={L:s[0],A:s[1],B:s[2]};return A.getDeltaE00(c,u)<n}function M(e,t){var a=e.x,n=e.y;return a>0&&a<t.width&&n>0&&n<t.height}var W=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];function L(e){var t,a=[],n=e.x,r=e.y,i=Object(j.a)(W);try{for(i.s();!(t=i.n()).done;){var c=t.value,o=Object(g.a)(c,2),s=o[0],u=o[1];a.push(new N({x:s+n,y:u+r}))}}catch(l){i.e(l)}finally{i.f()}return a}function X(e,t,a,n){return U.apply(this,arguments)}function U(){return(U=Object(p.a)(E.a.mark((function e(t,a,n,r){var i,c,o,s,u,l,h,d,m,f,v,p,g;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=a.leftX,c=a.rightX,o=a.height,s=0,u=new Set,l=Object(j.a)(r);try{for(l.s();!(h=l.n()).done;)for(d=h.value,m=d.x,f=d.y,v=f;v<o/2-5;v++)p=H(m,v),g={x:m,y:v},!u.has(p)&&i<=m&&m<=c&&(u.add(p),t.tint(g,n),s++)}catch(E){l.e(E)}finally{l.f()}return e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t){return String(e)+String(t)}var G=a(16),F=a.n(G);function z(e,t){return B.apply(this,arguments)}function B(){return(B=Object(p.a)(E.a.mark((function e(t,a){var n,r,i,c,o,s,u,l,h;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.width,r=t.height,a.drawImage(t,0,0,n,r),i=a.getImageData(0,0,n,r),450,320,c=F.a.U8_t,o=new F.a.matrix_t(450,320,c),F.a.imgproc.grayscale(i.data,n,r,o),3,8,120,120,F.a.imgproc.gaussian_blur(o,o,8,0),F.a.imgproc.canny(o,o,120,120),s=new Uint32Array(i.data.buffer),255<<24,u=o.cols*o.rows,l=0;--u>=0;)l=o.data[u],s[u]=255<<24|l<<16|l<<8|l;return a.putImageData(i,0,0,0,0,n,r),h=new I({canvasWidth:n,imageArray:i.data}),e.abrupt("return",h);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t,a,n){return Q.apply(this,arguments)}function Q(){return(Q=Object(p.a)(E.a.mark((function e(t,a,n,r){var i,c,o,s,u,l,h,d,m,f,v,p,g,y,b,O,x,_,w,j,C,N;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.width,c=t.height,o={detectionWidth:i,detectionHeight:c},s=n.current,u=s.getContext("2d"),e.next=6,z(t,u);case 6:return l=e.sent,(h=a.context).drawImage(t,0,0,i,c),d=h.getImageData(0,0,i,c),m=new I({canvasWidth:o.detectionWidth,imageArray:d.data}),e.next=13,q(m,o);case 13:return f=e.sent,e.next=16,P(m,f,l,{width:i,height:c},r);case 16:return v=e.sent,e.next=19,V(f,m,i,c);case 19:return p=e.sent,e.next=22,P(m,p,l,{width:i,height:c},r);case 22:return g=e.sent,y=v,b=g,f.y>p.y&&(y=(O=[b,y])[0],b=O[1]),e.next=28,Y(y,b);case 28:return x=e.sent,_=x.left,w=x.right,j={r:0,g:255,b:0},e.next=34,X(m,{leftX:_,rightX:w,height:c},j,y);case 34:return C=e.sent,e.next=37,X(m,{leftX:_,rightX:w,height:c},{r:0,g:0,b:255},b);case 37:return N=e.sent,h.putImageData(d,0,0,0,0,o.detectionWidth,o.detectionHeight),e.abrupt("return",Promise.resolve({topPixelsCount:C,bottomPixelsCount:N}));case 40:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e,t,a,n){return $.apply(this,arguments)}function $(){return($=Object(p.a)(E.a.mark((function e(t,a,n,r){var i,c,o,s,u,l,h,d,m,f,v,p;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=r/2,c=n/2,o=Math.abs(t.y-i),s=t.y,l=s,l+=(u=o<s)?-10:10,h={x:c},d=Number.MIN_SAFE_INTEGER,m=u?0:i;m!==l;)f={x:c,y:m},v=a.rgbPixel(f),(p=2*v.r-v.b-v.g)>d&&(h={y:m,x:c},d=p),u?m++:m--;return e.abrupt("return",h);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t){return K.apply(this,arguments)}function K(){return(K=Object(p.a)(E.a.mark((function e(t,a){var n,r,i,c,o,s,u,l,h;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=a.detectionWidth,r=a.detectionHeight,c={x:i=n/2},o=0,s=0;s<r/2;s++)u={x:i,y:s},l=t.rgbPixel(u),(h=2*l.r-l.b-l.g)>o&&(c.y=s,o=h);return e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t){return Z.apply(this,arguments)}function Z(){return(Z=Object(p.a)(E.a.mark((function e(t,a){var n,r,i,c,o,s,u,l,h,d,m,f;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=0,c=0,o=Object(j.a)(t);try{for(o.s();!(s=o.n()).done;)u=s.value,l=u.x,n=Math.min(n,l),i=Math.max(i,l)}catch(v){o.e(v)}finally{o.f()}h=Object(j.a)(a);try{for(h.s();!(d=h.n()).done;)m=d.value,f=m.x,r=Math.min(r,f),c=Math.max(c,f)}catch(v){h.e(v)}finally{h.f()}return e.abrupt("return",{left:Math.max(n,r),right:Math.min(i,c)});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ee=function(e){var t,a=Object(f.b)(),i=Object(f.c)((function(e){return e.combinedCanvasInfo})),c=Object(f.c)((function(e){return e.image.source})),u=Object(n.useState)(20),l=Object(g.a)(u,2),h=l[0],m=l[1],v=i.numColoredOuterPixels,x=i.numColoredInnerPixels,j=e.webcamRef,C=e.isPortrait,N=C?"flex-column":"",T=Object(d.a)({},e,{canvasContext:[i.context,y]}),I=Object(n.useRef)(null);function S(e){m((function(t){return Math.max(0,t+e)}))}function R(e){return A.apply(this,arguments)}function A(){return(A=Object(p.a)(E.a.mark((function e(t){var n,r,o,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h+t,e.next=3,J(c,i,I,n);case 3:r=e.sent,o=r.topPixelsCount,s=r.bottomPixelsCount,a(O(o)),a(b(s)),S(t);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){c&&R(0)}),[c]),r.a.createElement("div",null,r.a.createElement("div",{className:"d-flex justify-content-around align-items-center ".concat(N)},r.a.createElement(w,T),r.a.createElement("div",{className:"mt-3"},c&&r.a.createElement("div",null,!C&&r.a.createElement(s.a,{className:"my-4",variant:"outline-primary",onClick:function(){window.scrollTo(0,j.current.offsetTop)}},"Retake picture"),r.a.createElement("div",null,r.a.createElement(o.a,null,r.a.createElement(o.a.Body,null,r.a.createElement(o.a.Title,null,"Detect: ",h),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-around mb-3"},r.a.createElement(s.a,{onClick:function(e){R(-2)}},r.a.createElement(_.a,{icon:"minus",size:"1x"})),r.a.createElement(s.a,{onClick:function(e){R(2)}},r.a.createElement(_.a,{icon:"plus",size:"1x"}))),r.a.createElement("div",{className:"row justify-content-around"},r.a.createElement(s.a,{onClick:function(e){R(-5)}},r.a.createElement(_.a,{icon:"minus",size:"1x"}),"  ",r.a.createElement(_.a,{icon:"minus",size:"1x"})),r.a.createElement(s.a,{onClick:function(e){R(5)}},r.a.createElement(_.a,{icon:"plus",size:"1x"}),"  ",r.a.createElement(_.a,{icon:"plus",size:"1x"})))))),r.a.createElement("div",{className:"my-4"}))),c&&r.a.createElement("h3",{className:"mt-4"},"Loss:"," ",(100*((t=v)-x)/t).toFixed(4),"%")),C&&c&&r.a.createElement("label",null,"Rotate your device to retake picture")),r.a.createElement("canvas",{style:{display:"none"},ref:I}))},te=a(45),ae=a.n(te);a(94),a(95);var ne=Object(u.withOrientationChange)((function(e){var t=Object(f.b)(),a=Object(f.c)((function(e){return e.videoReducer.videoConstraints})),i=Object(f.c)((function(e){return e.image.source})),c=Object(f.c)((function(e){return e.canvasSettings.canvasDimensions})),u=e.isPortrait,l=Object(n.useRef)(null),d=Object(n.useRef)(null),m=Object(n.useRef)(null);Object(n.useEffect)((function(){}),[]);var v=Object(n.useCallback)((function(){var e,a=l.current.getScreenshot();t((e=a,function(t){var a=new Image;a.onload=function(){t({type:"IMAGE_SOURCE_SET",payload:a})},a.src=e})),t(function(e){return{type:"IMAGE_SET",payload:e}}(a)),window.scrollTo(0,m.current.offsetTop)}),[l]),E={webcamRef:l,image:i,canvasDimensions:{canvasWidth:c.width,canvasHeight:c.height},drawDimensions:{drawWidth:c.width,drawHeight:c.height},isPortrait:u};return r.a.createElement("div",{className:"App"},r.a.createElement("h2",null,"Ptosis calculator"),u&&!i&&r.a.createElement("h3",null,"Please rotate your device"),!u&&r.a.createElement(o.a,null,r.a.createElement("div",{className:"d-flex align-items-center mx-auto",ref:d},r.a.createElement("div",{style:{position:"relative",float:"top"}},r.a.createElement(h.a,{audio:!1,height:a.height,ref:l,screenshotFormat:"image/jpeg",width:a.width,videoConstraints:a}),r.a.createElement("div",{className:"overlay"},r.a.createElement("img",{className:"target",style:{height:a.height},src:ae.a}))),r.a.createElement("div",{className:"ml-5 my-3"},r.a.createElement(s.a,{onClick:function(){return v()}},r.a.createElement(_.a,{icon:"camera",size:"3x"}))))),r.a.createElement("div",{className:"mt-4",ref:m},r.a.createElement(ee,E)),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null))})),re=a(17),ie=a(46),ce=a(24);re.b.add(ie.a,ce.b,ce.c,ce.a);var oe=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ne,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(96);var se=a(15),ue=a(47);var le={isOuterEdit:!0};var he={context:null,recoloredImageData:null,numColoredPixels:0,detectedPixels:[],recolorHex:"#00FF00"};var de={context:null,recoloredImageData:null,numColoredPixels:0,detectedPixels:[],recolorHex:"#FFA500"};var me={canvasDimensions:{width:450,height:320}};var fe={videoConstraints:{width:450,height:320,facingMode:{exact:"environment"},audio:!1,imageSmoothing:!0,screenshotQuality:1}};var ve=Object(se.c)({image:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IMAGE_SOURCE_SET":return Object(d.a)({},e,{source:t.payload});case"IMAGE_SET":return Object(d.a)({},e,{image:t.payload});default:return e}},canvasEdit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_IS_OUTER_EDIT":return Object(d.a)({},e,{isOuterEdit:!e.isOuterEdit});default:return e}},innerCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_INNER_CONTEXT":return Object(d.a)({},e,{context:t.payload});case"SET_INNER_RECOLORED_IMAGE_DATA":return Object(d.a)({},e,{recoloredImageData:t.payload});case"SET_INNER_DETECTED_PIXELS":return Object(d.a)({},e,{detectedPixels:t.payload});case"SET_INNER_NUM_COLORED_PIXELS":return Object(d.a)({},e,{numColoredPixels:t.payload});case"SET_INNER_RECOLOR_HEX":return Object(d.a)({},e,{recolorHex:t.payload});default:return e}},outerCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_OUTER_CONTEXT":return Object(d.a)({},e,{context:t.payload});case"SET_OUTER_RECOLORED_IMAGE_DATA":return Object(d.a)({},e,{recoloredImageData:t.payload});case"SET_OUTER_DETECTED_PIXELS":return Object(d.a)({},e,{detectedPixels:t.payload});case"SET_OUTER_NUM_COLORED_PIXELS":return Object(d.a)({},e,{numColoredPixels:t.payload});case"SET_OUTER_RECOLOR_HEX":return Object(d.a)({},e,{recolorHex:t.payload});default:return e}},combinedCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_COMBINE_CONTEXT":return Object(d.a)({},e,{context:t.payload});case"SET_NUM_COLORED_INNER_PIXELS":return Object(d.a)({},e,{numColoredInnerPixels:t.payload});case"SET_NUM_COLORED_OUTER_PIXELS":return Object(d.a)({},e,{numColoredOuterPixels:t.payload});default:return e}},canvasSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CANVAS_DIMENSIONS":return Object(d.a)({},e,{source:t.payload});default:return e}},videoReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;return t.type,e}}),Ee=Object(se.d)(ve,Object(se.a)(ue.a));c.a.render(r.a.createElement(f.a,{store:Ee},r.a.createElement(oe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[49,1,2]]]);
//# sourceMappingURL=main.0994da84.chunk.js.map