(this["webpackJsonpcreate-react-plus"]=this["webpackJsonpcreate-react-plus"]||[]).push([[0],{24:function(e,t,n){e.exports=n.p+"static/media/target-thick.c9dcc9e1.png"},41:function(e,t,n){e.exports=n(66)},46:function(e,t,n){},60:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},66:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(19),i=n.n(c),o=(n(46),n(5)),u=n(68),l=n(21),s=n(13),d=n(3),m=n(67);function f(e){return{type:"SET_INNER_CONTEXT",payload:e}}function v(e){return{type:"SET_INNER_DETECTED_PIXELS",payload:e}}function E(e){return{type:"SET_INNER_RECOLOR_HEX",payload:e}}var h={context:null,recoloredImageData:null,numColoredPixels:0,detectedPixels:[],recolorHex:"#00FF00"};function p(e){return{type:"SET_OUTER_CONTEXT",payload:e}}function O(e){return{type:"SET_OUTER_DETECTED_PIXELS",payload:e}}function g(e){return{type:"SET_OUTER_RECOLOR_HEX",payload:e}}var y={context:null,recoloredImageData:null,numColoredPixels:0,detectedPixels:[],recolorHex:"#FFA500"};var b={isOuterEdit:!0};var x=function(){var e=Object(d.c)((function(e){return e.canvasEdit.isOuterEdit})),t=Object(d.b)(),n=function(){t({type:"TOGGLE_IS_OUTER_EDIT"})};return r.a.createElement("div",null,r.a.createElement("div",null,"Currently editing:"),r.a.createElement(u.a,{active:e,className:"mr-2",variant:"outline-danger",onClick:n},"Outer"),r.a.createElement(u.a,{active:!e,variant:"outline-primary",onClick:n},"Inner"))},j=n(7),_=n.n(j),C=n(9),N=n(15),T=n(38),I=n.n(T),w=n(22),R=function e(t){var n=t.x,a=t.y;Object(w.a)(this,e),this.x=n,this.y=a},S=n(39),D=function(){function e(t){var n=t.canvasWidth,a=t.imageArray;Object(w.a)(this,e),this.canvasWidth=n,this.imageArray=a}return Object(S.a)(e,[{key:"rgbPixel",value:function(e){var t=e.x,n=e.y,a=P(t,n,this.canvasWidth)+0,r=P(t,n,this.canvasWidth)+1,c=P(t,n,this.canvasWidth)+2;return{r:this.imageArray[a],g:this.imageArray[r],b:this.imageArray[c]}}},{key:"recolor",value:function(e,t){var n=t.r,a=t.g,r=t.b,c=e.x,i=e.y,o=P(c,i,this.canvasWidth)+0,u=P(c,i,this.canvasWidth)+1,l=P(c,i,this.canvasWidth)+2;this.imageArray[o]=Number(n),this.imageArray[u]=Number(a),this.imageArray[l]=Number(r)}}]),e}();function P(e,t,n){return 4*(e+t*n)}function X(e){return function(t){var n=t.r,a=t.g,r=t.b,c=Object(s.a)(I.a.rgb(n,a,r).hsl().color,3),i=c[0],o=c[1],u=c[2];return(i<e||i>360-e)&&o>=20&&(u>=20||u<=90)}}function k(e){return function(t){var n=t.r,a=t.g;return 2*t.b-(a+n)>255-e}}function L(e,t,n,a){return A.apply(this,arguments)}function A(){return(A=Object(C.a)(_.a.mark((function e(t,n,a,r){var c,i,o,u,l,s,d,m,f,v,E;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c=n.detectionWidth,i=n.detectionHeight,o=t.getImageData(0,0,c,i),u=J(r),l=[],s=new D({canvasWidth:c,imageArray:o.data}),d=0;d<i/2;d++)for(m=0;m<c;m++)f={x:m,y:d},v=s.rgbPixel(f),a(v)&&(s.recolor(f,u),E=new R(f),l.push(E));return e.abrupt("return",Promise.resolve([o,l]));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,n,a,r){return H.apply(this,arguments)}function H(){return(H=Object(C.a)(_.a.mark((function e(t,n,a,r,c){var i,o,u,l,s,d,m;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.width,o=t.height,u=c.leftX,l=c.rightX,s=r.context.getImageData(0,0,i,o),e.next=5,U({width:i,height:o},s,{leftX:u,rightX:l},n);case 5:return d=e.sent,e.next=8,U({width:i,height:o},s,{leftX:u,rightX:l},a);case 8:return m=e.sent,e.abrupt("return",Promise.resolve({imageData:s,outerNumPixelsColored:d,innerNumPixelsColored:m}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t,n,a){return W.apply(this,arguments)}function W(){return(W=Object(C.a)(_.a.mark((function e(t,n,a,r){var c,i,o,u,l,d,m,f,v,E,h,p,O,g,y,b,x,j,C,T;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.width,i=t.height,o=a.leftX,u=a.rightX,l=J(r.recolorHex),d=F(r.detectedPixels,{leftX:o,rightX:u}),m=d.numDetectedPixels,f=d.existingPixels,v=B(G,f),E=Object(N.a)(f);try{for(E.s();!(h=E.n()).done;)if(p=Object(s.a)(h.value,2),null!=(O=p[1]))for(g=O.x,y=O.y,b=y;b<i/2;b++)v(g,b)||(x=Q(g,b,c)+0,j=Q(g,b,c)+1,C=Q(g,b,c)+2,n.data[x]=l.r,n.data[j]=l.g,n.data[C]=l.b,T=G(g,b),f.set(T,null),m++)}catch(_){E.e(_)}finally{E.f()}return e.abrupt("return",m);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t){var n,a=t.leftX,r=t.rightX,c=new Map,i=0,o=Object(N.a)(e);try{for(o.s();!(n=o.n()).done;){var u=n.value,l=u.x,s=u.y;if(l>=a&&l<=r){var d=G(l,s);c.set(d,u),i++}}}catch(m){o.e(m)}finally{o.f()}return{numDetectedPixels:i,existingPixels:c}}function G(e,t){return String(e)+String(t)}function B(e,t){return function(n,a){var r=e(n,a);return t.has(r)}}function J(e){var t=0,n=0,a=0;return 4==e.length?(t="0x"+e[1]+e[1],n="0x"+e[2]+e[2],a="0x"+e[3]+e[3]):7==e.length&&(t="0x"+e[1]+e[2],n="0x"+e[3]+e[4],a="0x"+e[5]+e[6]),{r:t,g:n,b:a}}function Q(e,t,n){return 4*(e+t*n)}function V(e,t,n,a){null!=e&&e.drawImage(a,0,0,t,n)}function $(){return($=Object(C.a)(_.a.mark((function e(t,n,a,r,c,i){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),V(n,a,r,c),i(0);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q=function(e){var t=Object(d.b)(),n=Object(d.c)((function(e){return e.image.source})),a=Object(d.c)((function(e){return e.canvasEdit.isOuterEdit})),c=Object(d.c)((function(e){return e.outerCanvasInfo})),i=Object(d.c)((function(e){return e.innerCanvasInfo})),o=Object(d.c)((function(e){return e.canvasSettings.canvasDimensions})),l=o.width,m=o.height,E=e.recolorHex,h=Object(s.a)(e.detectionThreshold,1)[0],g=a?c:i;function y(){return(y=Object(C.a)(_.a.mark((function e(r){var c,i,o,u,l,d,m,g;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.width,i=n.height,o={detectionWidth:c,detectionHeight:i},u=a?X(h):k(h),e.next=5,L(r,o,u,E);case 5:l=e.sent,d=Object(s.a)(l,2),m=d[0],g=d[1],r.putImageData(m,0,0,0,0,c,i),t((a?p:f)(r)),t((a?O:v)(g));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",null,r.a.createElement(u.a,{variant:"outline-primary",className:"mx-1",onClick:function(){return function(e){return y.apply(this,arguments)}(g.context)}},"Recolor detected"),r.a.createElement(u.a,{variant:"outline-primary",className:"mx-1",onClick:function(e){var r=a?function(e){return function(t){e(function(e){return{type:"SET_OUTER_NUM_COLORED_PIXELS",payload:e}}(t))}}(t):function(e){return function(t){e(function(e){return{type:"SET_INNER_NUM_COLORED_PIXELS",payload:e}}(t))}}(t);t((a?O:v)([])),function(e,t,n,a,r,c){$.apply(this,arguments)}(e,g.context,l,m,n,r)}},"Reset"))};n(60);var z=function(e){var t=Object(d.b)(),n=Object(a.useState)(0),c=Object(s.a)(n,2),i=c[0],l=c[1],f=function(e){l((function(t){var n=(t=parseInt(t))+e;return n=(n=n<0?0:n)>255?255:n}))},v=Object(d.c)((function(e){return e.canvasEdit.isOuterEdit})),h=v?g:E,p=Object(d.c)((function(e){return e.innerCanvasInfo.recolorHex})),O=Object(d.c)((function(e){return e.outerCanvasInfo.recolorHex})),y=v?O:p,b=Object(o.a)({detectionThreshold:[i,l]},e,{recolorHex:y});return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(x,null)),r.a.createElement("div",null,r.a.createElement(m.a.Label,null,"Recolor:"),r.a.createElement(m.a.Control,{className:"mx-auto input",type:"color",value:y,onChange:function(e){var n=e.target.value;t(h(n))}})),r.a.createElement("div",null,r.a.createElement(m.a.Label,null,"Sensitivity: ",i),r.a.createElement("div",{className:"d-flex mx-auto mb-3 justify-content-center"},r.a.createElement(m.a.Control,{className:"input mx-2",type:"range",min:0,max:255,value:i,onChange:function(e){return l(e.target.value)}})),r.a.createElement("div",{className:"d-flex mx-auto justify-content-center"},r.a.createElement(u.a,{onClick:function(){f(-15)},variant:"outline-primary"},"-15"),r.a.createElement(u.a,{className:"mx-2",onClick:function(){f(-5)},variant:"outline-primary"},"-5"),r.a.createElement(u.a,{className:"mx-2",onClick:function(){f(-1)},variant:"outline-primary"},"-1"),r.a.createElement(u.a,{className:"mx-2",onClick:function(){f(1)},variant:"outline-primary"},"+1"),r.a.createElement(u.a,{className:"mx-2",onClick:function(){f(5)},variant:"outline-primary"},"+5"),r.a.createElement(u.a,{onClick:function(){f(15)},variant:"outline-primary"},"+15"))),r.a.createElement("div",{className:"m-2"},r.a.createElement(q,b)))};n(62);var K=function(e){var t=Object(d.b)(),n=e.image,c=e.canvasDimensions,i=c.canvasWidth,o=c.canvasHeight,u=e.drawDimensions,l=u.drawWidth,m=u.drawHeight,f=Object(s.a)(e.canvasContext,2),v=f[0],E=f[1],h=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=h.current.getContext("2d");t(E(e))}),[]),Object(a.useEffect)((function(){if(null!=n&&null!=v&&null!=h){var e=h.current;e.width=i,e.height=o,v.drawImage(n,0,0,l,m)}}),[n,l,m,i,o,v]),r.a.createElement("div",null,r.a.createElement("canvas",{ref:h,className:"border"}))},Y=n(23),Z=n.n(Y);function ee(e){return function(t){var n=new Image;n.onload=function(){t({type:"IMAGE_SET",payload:n})},n.src=e}}var te={source:null};function ne(e){return{type:"SET_COMBINE_CONTEXT",payload:e}}function ae(e){return{type:"SET_NUM_COLORED_INNER_PIXELS",payload:e}}function re(e){return{type:"SET_NUM_COLORED_OUTER_PIXELS",payload:e}}var ce={context:null,numColoredOuterPixels:0,numColoredInnerPixels:0};function ie(){return(ie=Object(C.a)(_.a.mark((function e(t,n,a,r,c){var i,o,u,l,s,d,m,f;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.detectedPixels,o=n.detectedPixels,e.next=4,oe(i,o);case 4:return u=e.sent,e.next=7,le(i,o);case 7:return l=e.sent,e.next=10,M(r,t,n,a,{leftX:u,rightX:l});case 10:s=e.sent,d=s.imageData,m=s.outerNumPixelsColored,f=s.innerNumPixelsColored,a.context.putImageData(d,0,0,0,0,r.width,r.height),c(ne(a.context)),c(ae(f)),c(re(m));case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e,t){return ue.apply(this,arguments)}function ue(){return(ue=Object(C.a)(_.a.mark((function e(t,n){var a,r,c,i,o,u,l,s,d,m;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Number.MAX_SAFE_INTEGER,r=Object(N.a)(t);try{for(r.s();!(c=r.n()).done;)i=c.value,o=i.x,a=Math.min(a,o)}catch(f){r.e(f)}finally{r.f()}u=Number.MAX_SAFE_INTEGER,l=Object(N.a)(n);try{for(l.s();!(s=l.n()).done;)d=s.value,m=d.x,u=Math.min(u,m)}catch(f){l.e(f)}finally{l.f()}return e.abrupt("return",Math.max(a,u));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e,t){return se.apply(this,arguments)}function se(){return(se=Object(C.a)(_.a.mark((function e(t,n){var a,r,c,i,o,u,l,s,d,m;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,r=Object(N.a)(t);try{for(r.s();!(c=r.n()).done;)i=c.value,o=i.x,a=Math.max(a,o)}catch(f){r.e(f)}finally{r.f()}u=0,l=Object(N.a)(n);try{for(l.s();!(s=l.n()).done;)d=s.value,m=d.x,u=Math.max(u,m)}catch(f){l.e(f)}finally{l.f()}return e.abrupt("return",Math.min(a,u));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var de=function(e){var t,n=Object(d.b)(),a=Object(d.c)((function(e){return e.outerCanvasInfo})),c=Object(d.c)((function(e){return e.innerCanvasInfo})),i=Object(d.c)((function(e){return e.combinedCanvasInfo})),l=Object(d.c)((function(e){return e.canvasSettings.canvasDimensions})),s=i.numColoredOuterPixels,m=i.numColoredInnerPixels,f=Object(o.a)({},e,{canvasContext:[i.context,ne]});return r.a.createElement("div",null,r.a.createElement(K,f),r.a.createElement(u.a,{className:"my-2",variant:"outline-primary",onClick:function(){!function(e,t,n,a,r){ie.apply(this,arguments)}(a,c,i,l,n)}},"Recolor"),r.a.createElement("div",null,r.a.createElement("div",null,"Outer pixel count: ",s),r.a.createElement("div",null,"Inner pixel count: ",m),r.a.createElement("div",null,"Calculated Loss %:"," ",(100*((t=s)-m)/t).toFixed(4))))},me=(n(63),n(24)),fe=n.n(me);var ve=Object(l.withOrientationChange)((function(e){var t=Object(d.b)(),n=Object(d.c)((function(e){return e.videoReducer.videoConstraints})),c=Object(d.c)((function(e){return e.image.source})),i=Object(d.c)((function(e){return e.innerCanvasInfo.context})),l=Object(d.c)((function(e){return e.outerCanvasInfo.context})),s=Object(d.c)((function(e){return e.canvasSettings.canvasDimensions})),m=e.isPortrait,v=Object(a.useRef)(null),E=Object(a.useRef)(null),h=Object(a.useCallback)((function(){var e=v.current.getScreenshot();t(ee(e))}),[v]),O={image:c,canvasDimensions:{canvasWidth:s.width,canvasHeight:s.height},drawDimensions:{drawWidth:s.width,drawHeight:s.height},canvasContext:[l,p]},g=Object(o.a)({},O,{canvasContext:[i,f]}),y=Object(o.a)({},g);return r.a.createElement("div",{className:"App"},m&&r.a.createElement("h5",null,"Please rotate your device"),!m&&r.a.createElement("div",{className:"d-flex justify-content-around align-items-center",ref:E},r.a.createElement("div",{style:{position:"relative",float:"top"}},r.a.createElement(Z.a,{audio:!1,height:n.height,ref:v,screenshotFormat:"image/jpeg",width:n.width,videoConstraints:n}),r.a.createElement("div",{className:"overlay"},r.a.createElement("img",{className:"target",style:{height:n.height},src:fe.a}))),r.a.createElement("div",{className:"my-3"},r.a.createElement(u.a,{onClick:function(){return h()},variant:"outline-primary"},"Take picture"))),r.a.createElement(K,O),r.a.createElement(K,g),r.a.createElement(z,null),r.a.createElement("div",null,r.a.createElement(de,y)))}));var Ee=Object(l.withOrientationChange)((function(e){var t=Object(d.b)(),n=Object(d.c)((function(e){return e.videoReducer.videoConstraints})),c=Object(d.c)((function(e){return e.image.source})),i=Object(d.c)((function(e){return e.canvasSettings.canvasDimensions})),o=(e.isLandscape,e.isPortrait),l=Object(a.useRef)(null),s=Object(a.useRef)(null),m=Object(a.useCallback)((function(){var e=l.current.getScreenshot();t(ee(e))}),[l]),f={image:c,canvasDimensions:{canvasWidth:i.width,canvasHeight:i.height},drawDimensions:{drawWidth:i.width,drawHeight:i.height}};return r.a.createElement("div",{className:"App"},o&&r.a.createElement("h5",null,"Please rotate your device"),!o&&r.a.createElement("div",{className:"d-flex justify-content-around align-items-center",ref:s},r.a.createElement("div",{style:{position:"relative",float:"top"}},r.a.createElement(Z.a,{audio:!1,height:n.height,ref:l,screenshotFormat:"image/jpeg",width:n.height,videoConstraints:n}),r.a.createElement("div",{className:"overlay"},r.a.createElement("img",{style:{height:n.height},src:fe.a}))),r.a.createElement("div",{className:"my-3"},r.a.createElement(u.a,{onClick:function(){return m()},variant:"outline-primary"},"Take pictures"))),r.a.createElement("div",null,r.a.createElement(de,f)))})),he=n(26),pe=n(8);var Oe=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(he.a,null,r.a.createElement("div",null,r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(he.b,{to:"/auto",activeClassName:"selected"},"Auto")),r.a.createElement("li",null,r.a.createElement(he.b,{to:"/manual",activeClassName:"selected"},"Manual")))),r.a.createElement(pe.c,null,r.a.createElement(pe.a,{path:"/manual"},r.a.createElement(ve,null)),r.a.createElement(pe.a,{path:"/auto"},r.a.createElement(Ee,null))))))};var ge=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(65);var ye=n(16),be=n(40);var xe={canvasDimensions:{width:450,height:320}};var je={videoConstraints:{width:450,height:320,facingMode:{exact:"environment"},audio:!1,imageSmoothing:!0,screenshotQuality:1}};var _e=Object(ye.c)({image:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IMAGE_SET":return Object(o.a)({},e,{source:t.payload});default:return e}},canvasEdit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_IS_OUTER_EDIT":return Object(o.a)({},e,{isOuterEdit:!e.isOuterEdit});default:return e}},innerCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_INNER_CONTEXT":return Object(o.a)({},e,{context:t.payload});case"SET_INNER_RECOLORED_IMAGE_DATA":return Object(o.a)({},e,{recoloredImageData:t.payload});case"SET_INNER_DETECTED_PIXELS":return Object(o.a)({},e,{detectedPixels:t.payload});case"SET_INNER_NUM_COLORED_PIXELS":return Object(o.a)({},e,{numColoredPixels:t.payload});case"SET_INNER_RECOLOR_HEX":return Object(o.a)({},e,{recolorHex:t.payload});default:return e}},outerCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_OUTER_CONTEXT":return Object(o.a)({},e,{context:t.payload});case"SET_OUTER_RECOLORED_IMAGE_DATA":return Object(o.a)({},e,{recoloredImageData:t.payload});case"SET_OUTER_DETECTED_PIXELS":return Object(o.a)({},e,{detectedPixels:t.payload});case"SET_OUTER_NUM_COLORED_PIXELS":return Object(o.a)({},e,{numColoredPixels:t.payload});case"SET_OUTER_RECOLOR_HEX":return Object(o.a)({},e,{recolorHex:t.payload});default:return e}},combinedCanvasInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_COMBINE_CONTEXT":return Object(o.a)({},e,{context:t.payload});case"SET_NUM_COLORED_INNER_PIXELS":return Object(o.a)({},e,{numColoredInnerPixels:t.payload});case"SET_NUM_COLORED_OUTER_PIXELS":return Object(o.a)({},e,{numColoredOuterPixels:t.payload});default:return e}},canvasSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CANVAS_DIMENSIONS":return Object(o.a)({},e,{source:t.payload});default:return e}},videoReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,t=arguments.length>1?arguments[1]:void 0;return t.type,e}}),Ce=Object(ye.d)(_e,Object(ye.a)(be.a));i.a.render(r.a.createElement(d.a,{store:Ce},r.a.createElement(ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[41,1,2]]]);
//# sourceMappingURL=main.f833fb75.chunk.js.map